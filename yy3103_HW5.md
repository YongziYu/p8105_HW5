p8105\_HW5
================
Yongzi Yu yy3103

I’m an R Markdown document!

``` r
library(tidyverse)
```

    ## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──

    ## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
    ## ✓ tibble  3.1.2     ✓ dplyr   1.0.7
    ## ✓ tidyr   1.1.3     ✓ stringr 1.4.0
    ## ✓ readr   1.4.0     ✓ forcats 0.5.1

    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

``` r
library(broom)
library(purrr)
```

# Problem1

\#load data homicide= read\_csv(“./homicide-data.csv”)%&gt;%
janitor::clean\_names() %&gt;% mutate( city\_state =
paste(city,“,”,state) ) \#create a variable

\#describe the raw data set

\#obtain total number of homicides and unsolved summary\_total= homicide
%&gt;% group\_by(city) %&gt;% summarise(total=n())

summary\_unsolved= homicide %&gt;% filter(disposition ==“Closed without
arrest” \|disposition == “Open/No arrest”) %&gt;% group\_by(city) %&gt;%
summarise(total=n())

\#prop test for Baltimore bal\_total= summary\_total %&gt;% filter(city
== “Baltimore”) bal\_unsolved= summary\_unsolved %&gt;% filter(city ==
“Baltimore”)

res=
prop.test(x=bal\_unsolved*t**o**t**a**l*, *n* = *b**a**l*<sub>*t*</sub>*o**t**a**l*total)
res res %&gt;% broom::tidy() res

# Problem2

``` r
files=
  list.files (path = "./data")
files
```

    ##  [1] "con_01.csv" "con_02.csv" "con_03.csv" "con_04.csv" "con_05.csv"
    ##  [6] "con_06.csv" "con_07.csv" "con_08.csv" "con_09.csv" "con_10.csv"
    ## [11] "exp_01.csv" "exp_02.csv" "exp_03.csv" "exp_04.csv" "exp_05.csv"
    ## [16] "exp_06.csv" "exp_07.csv" "exp_08.csv" "exp_09.csv" "exp_10.csv"

``` r
file_data=
  list.files (path = "./data") %>%
  map_df(read_csv)
```

    ## 
    ## ── Column specification ────────────────────────────────────────────────────────
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## 
    ## 
    ## ── Column specification ────────────────────────────────────────────────────────
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## 
    ## 
    ## ── Column specification ────────────────────────────────────────────────────────
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## 
    ## 
    ## ── Column specification ────────────────────────────────────────────────────────
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## 
    ## 
    ## ── Column specification ────────────────────────────────────────────────────────
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## 
    ## 
    ## ── Column specification ────────────────────────────────────────────────────────
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## 
    ## 
    ## ── Column specification ────────────────────────────────────────────────────────
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## 
    ## 
    ## ── Column specification ────────────────────────────────────────────────────────
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## 
    ## 
    ## ── Column specification ────────────────────────────────────────────────────────
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## 
    ## 
    ## ── Column specification ────────────────────────────────────────────────────────
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## 
    ## 
    ## ── Column specification ────────────────────────────────────────────────────────
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## 
    ## 
    ## ── Column specification ────────────────────────────────────────────────────────
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## 
    ## 
    ## ── Column specification ────────────────────────────────────────────────────────
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## 
    ## 
    ## ── Column specification ────────────────────────────────────────────────────────
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## 
    ## 
    ## ── Column specification ────────────────────────────────────────────────────────
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## 
    ## 
    ## ── Column specification ────────────────────────────────────────────────────────
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## 
    ## 
    ## ── Column specification ────────────────────────────────────────────────────────
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## 
    ## 
    ## ── Column specification ────────────────────────────────────────────────────────
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## 
    ## 
    ## ── Column specification ────────────────────────────────────────────────────────
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )
    ## 
    ## 
    ## ── Column specification ────────────────────────────────────────────────────────
    ## cols(
    ##   week_1 = col_double(),
    ##   week_2 = col_double(),
    ##   week_3 = col_double(),
    ##   week_4 = col_double(),
    ##   week_5 = col_double(),
    ##   week_6 = col_double(),
    ##   week_7 = col_double(),
    ##   week_8 = col_double()
    ## )

``` r
file_data
```

    ## # A tibble: 20 x 8
    ##    week_1 week_2 week_3 week_4 week_5 week_6 week_7 week_8
    ##     <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>
    ##  1   0.2   -1.31   0.66   1.96   0.23   1.09   0.05   1.94
    ##  2   1.13  -0.88   1.07   0.17  -0.83  -0.31   1.58   0.44
    ##  3   1.77   3.11   2.22   3.26   3.31   0.89   1.88   1.01
    ##  4   1.04   3.66   1.22   2.33   1.47   2.7    1.87   1.66
    ##  5   0.47  -0.58  -0.09  -1.37  -0.32  -2.17   0.45   0.48
    ##  6   2.37   2.5    1.59  -0.16   2.08   3.07   0.78   2.35
    ##  7   0.03   1.21   1.13   0.64   0.49  -0.12  -0.07   0.46
    ##  8  -0.08   1.42   0.09   0.36   1.18  -1.16   0.33  -0.44
    ##  9   0.08   1.24   1.44   0.41   0.95   2.75   0.3    0.03
    ## 10   2.14   1.15   2.52   3.44   4.26   0.97   2.73  -0.53
    ## 11   3.05   3.67   4.84   5.8    6.33   5.46   6.38   5.91
    ## 12  -0.84   2.63   1.64   2.58   1.24   2.32   3.11   3.78
    ## 13   2.15   2.08   1.82   2.84   3.36   3.61   3.37   3.74
    ## 14  -0.62   2.54   3.78   2.73   4.49   5.82   6      6.49
    ## 15   0.7    3.33   5.34   5.57   6.9    6.66   6.24   6.95
    ## 16   3.73   4.08   5.4    6.41   4.87   6.09   7.66   5.83
    ## 17   1.18   2.35   1.23   1.17   2.02   1.61   3.13   4.88
    ## 18   1.37   1.43   1.84   3.6    3.8    4.72   4.68   5.7 
    ## 19  -0.4    1.08   2.66   2.7    2.8    2.64   3.51   3.27
    ## 20   1.09   2.8    2.8    4.3    2.25   6.57   6.09   4.64

``` r
combine=cbind(files,file_data)
combine
```

    ##         files week_1 week_2 week_3 week_4 week_5 week_6 week_7 week_8
    ## 1  con_01.csv   0.20  -1.31   0.66   1.96   0.23   1.09   0.05   1.94
    ## 2  con_02.csv   1.13  -0.88   1.07   0.17  -0.83  -0.31   1.58   0.44
    ## 3  con_03.csv   1.77   3.11   2.22   3.26   3.31   0.89   1.88   1.01
    ## 4  con_04.csv   1.04   3.66   1.22   2.33   1.47   2.70   1.87   1.66
    ## 5  con_05.csv   0.47  -0.58  -0.09  -1.37  -0.32  -2.17   0.45   0.48
    ## 6  con_06.csv   2.37   2.50   1.59  -0.16   2.08   3.07   0.78   2.35
    ## 7  con_07.csv   0.03   1.21   1.13   0.64   0.49  -0.12  -0.07   0.46
    ## 8  con_08.csv  -0.08   1.42   0.09   0.36   1.18  -1.16   0.33  -0.44
    ## 9  con_09.csv   0.08   1.24   1.44   0.41   0.95   2.75   0.30   0.03
    ## 10 con_10.csv   2.14   1.15   2.52   3.44   4.26   0.97   2.73  -0.53
    ## 11 exp_01.csv   3.05   3.67   4.84   5.80   6.33   5.46   6.38   5.91
    ## 12 exp_02.csv  -0.84   2.63   1.64   2.58   1.24   2.32   3.11   3.78
    ## 13 exp_03.csv   2.15   2.08   1.82   2.84   3.36   3.61   3.37   3.74
    ## 14 exp_04.csv  -0.62   2.54   3.78   2.73   4.49   5.82   6.00   6.49
    ## 15 exp_05.csv   0.70   3.33   5.34   5.57   6.90   6.66   6.24   6.95
    ## 16 exp_06.csv   3.73   4.08   5.40   6.41   4.87   6.09   7.66   5.83
    ## 17 exp_07.csv   1.18   2.35   1.23   1.17   2.02   1.61   3.13   4.88
    ## 18 exp_08.csv   1.37   1.43   1.84   3.60   3.80   4.72   4.68   5.70
    ## 19 exp_09.csv  -0.40   1.08   2.66   2.70   2.80   2.64   3.51   3.27
    ## 20 exp_10.csv   1.09   2.80   2.80   4.30   2.25   6.57   6.09   4.64

``` r
tidy=
  combine%>%
  pivot_longer(
    week_1:week_8,
    names_to = "week",
    values_to = "value"
  )
tidy
```

    ## # A tibble: 160 x 3
    ##    files      week   value
    ##    <chr>      <chr>  <dbl>
    ##  1 con_01.csv week_1  0.2 
    ##  2 con_01.csv week_2 -1.31
    ##  3 con_01.csv week_3  0.66
    ##  4 con_01.csv week_4  1.96
    ##  5 con_01.csv week_5  0.23
    ##  6 con_01.csv week_6  1.09
    ##  7 con_01.csv week_7  0.05
    ##  8 con_01.csv week_8  1.94
    ##  9 con_02.csv week_1  1.13
    ## 10 con_02.csv week_2 -0.88
    ## # … with 150 more rows

# Problem 3

``` r
library(tidyverse)
set.seed(10)
iris_with_missing = iris %>% 
  map_df(~replace(.x, sample(1:150, 20), NA)) %>%
  mutate(Species = as.character(Species))
iris_with_missing
```

    ## # A tibble: 150 x 5
    ##    Sepal.Length Sepal.Width Petal.Length Petal.Width Species
    ##           <dbl>       <dbl>        <dbl>       <dbl> <chr>  
    ##  1          5.1         3.5          1.4         0.2 setosa 
    ##  2          4.9         3            1.4         0.2 setosa 
    ##  3          4.7         3.2          1.3         0.2 setosa 
    ##  4          4.6         3.1          1.5        NA   setosa 
    ##  5          5           3.6          1.4         0.2 setosa 
    ##  6          5.4         3.9          1.7         0.4 setosa 
    ##  7         NA           3.4          1.4         0.3 setosa 
    ##  8          5           3.4          1.5         0.2 setosa 
    ##  9          4.4         2.9          1.4         0.2 setosa 
    ## 10          4.9         3.1         NA           0.1 setosa 
    ## # … with 140 more rows

``` r
missing = function(x) {
  if (is.character(x$Species)) {
    x$Species %>% replace_na('abc')
  }
  else {for (i in 1:4){
    x[,i][is.na(x[,i])]=mean(x[,i],na.rm=TRUE)
  }
  }
}

a=missing(iris_with_missing)
a
```

    ##   [1] "setosa"     "setosa"     "setosa"     "setosa"     "setosa"    
    ##   [6] "setosa"     "setosa"     "setosa"     "setosa"     "setosa"    
    ##  [11] "setosa"     "setosa"     "setosa"     "setosa"     "setosa"    
    ##  [16] "setosa"     "setosa"     "setosa"     "setosa"     "setosa"    
    ##  [21] "setosa"     "abc"        "setosa"     "setosa"     "abc"       
    ##  [26] "setosa"     "abc"        "setosa"     "setosa"     "setosa"    
    ##  [31] "setosa"     "setosa"     "setosa"     "setosa"     "setosa"    
    ##  [36] "setosa"     "setosa"     "setosa"     "setosa"     "setosa"    
    ##  [41] "setosa"     "abc"        "setosa"     "setosa"     "setosa"    
    ##  [46] "abc"        "setosa"     "setosa"     "setosa"     "setosa"    
    ##  [51] "abc"        "versicolor" "versicolor" "versicolor" "versicolor"
    ##  [56] "versicolor" "abc"        "versicolor" "abc"        "versicolor"
    ##  [61] "versicolor" "versicolor" "versicolor" "versicolor" "versicolor"
    ##  [66] "versicolor" "versicolor" "versicolor" "versicolor" "versicolor"
    ##  [71] "versicolor" "abc"        "versicolor" "versicolor" "versicolor"
    ##  [76] "versicolor" "versicolor" "versicolor" "versicolor" "abc"       
    ##  [81] "versicolor" "versicolor" "versicolor" "versicolor" "versicolor"
    ##  [86] "versicolor" "versicolor" "versicolor" "versicolor" "versicolor"
    ##  [91] "versicolor" "versicolor" "versicolor" "abc"        "versicolor"
    ##  [96] "versicolor" "versicolor" "versicolor" "versicolor" "abc"       
    ## [101] "virginica"  "virginica"  "virginica"  "virginica"  "virginica" 
    ## [106] "virginica"  "virginica"  "virginica"  "virginica"  "virginica" 
    ## [111] "virginica"  "virginica"  "abc"        "virginica"  "abc"       
    ## [116] "virginica"  "virginica"  "abc"        "abc"        "virginica" 
    ## [121] "virginica"  "virginica"  "virginica"  "virginica"  "virginica" 
    ## [126] "virginica"  "virginica"  "abc"        "virginica"  "virginica" 
    ## [131] "virginica"  "virginica"  "virginica"  "virginica"  "virginica" 
    ## [136] "virginica"  "abc"        "virginica"  "virginica"  "virginica" 
    ## [141] "virginica"  "virginica"  "virginica"  "virginica"  "virginica" 
    ## [146] "virginica"  "abc"        "abc"        "virginica"  "virginica"
